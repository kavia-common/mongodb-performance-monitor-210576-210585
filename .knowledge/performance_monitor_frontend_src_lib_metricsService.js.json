{"is_source_file": true, "format": "JavaScript", "description": "This file defines a Metrics Service module for a React-based frontend application. It handles fetching metrics data either from real backend endpoints or mock data, based on feature flags. It includes utility functions for parsing feature flags, handling errors, generating mock time series data, and exposing public functions to get metrics snapshots, timeseries data, and perform a health check.", "external_files": ["./api"], "external_methods": ["get"], "published": ["getMetricsSnapshot", "getMetricsTimeseries", "tryHealthCheck"], "classes": [], "methods": [{"name": "parseFeatureFlags()", "description": "Parses feature flags from environment variables to determine configuration options.", "scope": "", "scopeKind": ""}, {"name": "isMissingEndpointError(err)", "description": "Determines if an error is due to a missing API endpoint based on error properties.", "scope": "", "scopeKind": ""}, {"name": "clamp(n, min, max)", "description": "Constrains a number within min and max bounds.", "scope": "", "scopeKind": ""}, {"name": "delay(ms = 180)", "description": "Returns a promise that resolves after a specified delay in milliseconds.", "scope": "", "scopeKind": ""}, {"name": "pseudo(i)", "description": "Generates a deterministic pseudo-random number based on an input index.", "scope": "", "scopeKind": ""}, {"name": "buildMockSeries(opts = {})", "description": "Generates mock time series data points for a given time window and step.", "scope": "", "scopeKind": ""}, {"name": "summarize(points)", "description": "Extracts a summary from a series of points, typically the last point.", "scope": "", "scopeKind": ""}, {"name": "realOrMock(realCall, mockCall)", "description": "Attempts to call a real API function; falls back to mock if real API is unavailable or not implemented.", "scope": "", "scopeKind": ""}, {"name": "getMetricsSnapshot({ instanceId } = {})", "description": "Fetches current metrics summary, either from backend or mock data.", "scope": "", "scopeKind": ""}, {"name": "getMetricsTimeseries({ instanceId, windowSec = 300, stepSec = 10 } = {})", "description": "Fetches metrics timeseries data for charts, either real or mock.", "scope": "", "scopeKind": ""}, {"name": "tryHealthCheck()", "description": "Performs a health check to verify backend connectivity.", "scope": "", "scopeKind": ""}], "calls": ["get"], "search-terms": ["MetricsService", "parseFeatureFlags", "buildMockSeries", "metricsApi", "getMetricsSnapshot", "getMetricsTimeseries", "tryHealthCheck", "mock", "real"], "state": 2, "file_id": 24, "knowledge_revision": 62, "git_revision": "", "revision_history": [{"60": ""}, {"62": ""}], "ctags": [{"_type": "tag", "name": "MODE", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210585/performance_monitor_frontend/src/lib/metricsService.js", "pattern": "/^const MODE = (FLAGS.metricsApi || \"mock\").toLowerCase(); \\/\\/ \"mock\" | \"real\"$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "buildMockSeries", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210585/performance_monitor_frontend/src/lib/metricsService.js", "pattern": "/^function buildMockSeries(opts = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "(opts = {})"}, {"_type": "tag", "name": "clamp", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210585/performance_monitor_frontend/src/lib/metricsService.js", "pattern": "/^function clamp(n, min, max) {$/", "language": "JavaScript", "kind": "function", "signature": "(n, min, max)"}, {"_type": "tag", "name": "delay", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210585/performance_monitor_frontend/src/lib/metricsService.js", "pattern": "/^function delay(ms = 180) {$/", "language": "JavaScript", "kind": "function", "signature": "(ms = 180)"}, {"_type": "tag", "name": "getMetricsSnapshot", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210585/performance_monitor_frontend/src/lib/metricsService.js", "pattern": "/^export async function getMetricsSnapshot({ instanceId } = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "({ instanceId } = {})"}, {"_type": "tag", "name": "getMetricsTimeseries", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210585/performance_monitor_frontend/src/lib/metricsService.js", "pattern": "/^export async function getMetricsTimeseries({ instanceId, windowSec = 300, stepSec = 10 } = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "({ instanceId, windowSec = 300, stepSec = 10 } = {})"}, {"_type": "tag", "name": "isMissingEndpointError", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210585/performance_monitor_frontend/src/lib/metricsService.js", "pattern": "/^function isMissingEndpointError(err) {$/", "language": "JavaScript", "kind": "function", "signature": "(err)"}, {"_type": "tag", "name": "parseFeatureFlags", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210585/performance_monitor_frontend/src/lib/metricsService.js", "pattern": "/^function parseFeatureFlags() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "pseudo", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210585/performance_monitor_frontend/src/lib/metricsService.js", "pattern": "/^function pseudo(i) {$/", "language": "JavaScript", "kind": "function", "signature": "(i)"}, {"_type": "tag", "name": "realOrMock", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210585/performance_monitor_frontend/src/lib/metricsService.js", "pattern": "/^async function realOrMock(realCall, mockCall) {$/", "language": "JavaScript", "kind": "function", "signature": "(realCall, mockCall)"}, {"_type": "tag", "name": "summarize", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210585/performance_monitor_frontend/src/lib/metricsService.js", "pattern": "/^function summarize(points) {$/", "language": "JavaScript", "kind": "function", "signature": "(points)"}, {"_type": "tag", "name": "tryHealthCheck", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210585/performance_monitor_frontend/src/lib/metricsService.js", "pattern": "/^export async function tryHealthCheck() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}], "hash": "fe32366b1d38cf4d4b1b34d3399c435d", "format-version": 4, "code-base-name": "performance_monitor_frontend", "filename": "performance_monitor_frontend/src/lib/metricsService.js"}